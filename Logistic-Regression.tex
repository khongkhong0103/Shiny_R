% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\author{}
\date{\vspace{-2.5em}}

\begin{document}

\hypertarget{hux1ed3i-quy-logisticlogistic-regression}{%
\section{Hồi quy Logistic(Logistic
Regression)}\label{hux1ed3i-quy-logisticlogistic-regression}}

Phân tích hồi qui logistic là một kỹ thuật thống kê để xem xét mối liên
hệ giữa biến độc lập (biến số hoặc biến phân loại) với biến phụ thuộc là
biến nhị phân \#\# Nhận dữ liệu

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --
\end{verbatim}

\begin{verbatim}
## v ggplot2 3.3.5     v purrr   0.3.4
## v tibble  3.1.4     v dplyr   1.0.7
## v tidyr   1.1.3     v stringr 1.4.0
## v readr   2.0.1     v forcats 0.5.1
\end{verbatim}

\begin{verbatim}
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{setwd}\NormalTok{(}\StringTok{"D:/2. School/CuoiKi R 2"}\NormalTok{)}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\AttributeTok{file=}\StringTok{\textquotesingle{}./data/xAPI{-}Edu{-}Data.csv\textquotesingle{}}\NormalTok{)}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{select}\NormalTok{(df, }\SpecialCharTok{{-}}\NormalTok{PlaceofBirth, }\SpecialCharTok{{-}}\NormalTok{StageID, }\SpecialCharTok{{-}}\NormalTok{SectionID, }\SpecialCharTok{{-}}\NormalTok{Semester, }\SpecialCharTok{{-}}\NormalTok{Relation, }\SpecialCharTok{{-}}\NormalTok{ParentAnsweringSurvey,}\SpecialCharTok{{-}}\NormalTok{GradeID,}\SpecialCharTok{{-}}\NormalTok{Topic,}\SpecialCharTok{{-}}\NormalTok{gender,  }\SpecialCharTok{{-}}\NormalTok{ParentschoolSatisfaction,}\SpecialCharTok{{-}}\NormalTok{NationalITy)}
\end{Highlighting}
\end{Shaded}

\textbf{Tạo thêm 1 cột mới để chỉ xem class có Phải là high không}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{add\_column}\NormalTok{(}\AttributeTok{ClassH =} \FunctionTok{if\_else}\NormalTok{(.}\SpecialCharTok{$}\NormalTok{Class }\SpecialCharTok{==} \StringTok{"H"}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{))}
\FunctionTok{head}\NormalTok{(df,}\DecValTok{30}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    raisedhands VisITedResources AnnouncementsView Discussion StudentAbsenceDays
## 1           15               16                 2         20            Under-7
## 2           20               20                 3         25            Under-7
## 3           10                7                 0         30            Above-7
## 4           30               25                 5         35            Above-7
## 5           40               50                12         50            Above-7
## 6           42               30                13         70            Above-7
## 7           35               12                 0         17            Above-7
## 8           50               10                15         22            Under-7
## 9           12               21                16         50            Under-7
## 10          70               80                25         70            Under-7
## 11          50               88                30         80            Under-7
## 12          19                6                19         12            Under-7
## 13           5                1                 0         11            Above-7
## 14          20               14                12         19            Above-7
## 15          62               70                44         60            Above-7
## 16          30               40                22         66            Under-7
## 17          36               30                20         80            Above-7
## 18          55               13                35         90            Above-7
## 19          69               15                36         96            Under-7
## 20          70               50                40         99            Under-7
## 21          60               60                33         90            Above-7
## 22          10               12                 4         80            Under-7
## 23          15               21                 2         90            Under-7
## 24           2                0                 2         50            Above-7
## 25           0                2                 3         70            Above-7
## 26           8                7                30         40            Above-7
## 27          19               19                25         40            Under-7
## 28          25               15                12         33            Above-7
## 29          75               85                52         43            Under-7
## 30          30               90                33         35            Under-7
##    Class ClassH
## 1      M      0
## 2      M      0
## 3      L      0
## 4      L      0
## 5      M      0
## 6      M      0
## 7      L      0
## 8      M      0
## 9      M      0
## 10     M      0
## 11     H      1
## 12     M      0
## 13     L      0
## 14     L      0
## 15     H      1
## 16     M      0
## 17     M      0
## 18     M      0
## 19     M      0
## 20     H      1
## 21     M      0
## 22     M      0
## 23     M      0
## 24     L      0
## 25     L      0
## 26     L      0
## 27     M      0
## 28     L      0
## 29     M      0
## 30     M      0
\end{verbatim}

\hypertarget{chuux1ea9n-bux1ecb-dux1eef-liux1ec7u}{%
\section{chuẩn bị dữ liệu}\label{chuux1ea9n-bux1ecb-dux1eef-liux1ec7u}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# the\_data$Education \textless{}{-} as.factor(the\_data$Education)}
\FunctionTok{library}\NormalTok{(caTools)}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{101}\NormalTok{) }
\NormalTok{sample }\OtherTok{\textless{}{-}} \FunctionTok{sample.split}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{Class, }\AttributeTok{SplitRatio =} \FloatTok{0.70}\NormalTok{) }\CommentTok{\# SplitRatio = percent of sample==TRUE}
\CommentTok{\# Training Data}
\NormalTok{train }\OtherTok{=} \FunctionTok{subset}\NormalTok{(df, sample }\SpecialCharTok{==} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Testing Data}
\NormalTok{test }\OtherTok{=} \FunctionTok{subset}\NormalTok{(df, sample }\SpecialCharTok{==} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{xuxe2y-dux1ee5ng-model}{%
\section{Xây dụng Model}\label{xuxe2y-dux1ee5ng-model}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# model = glm(ClassH \textasciitilde{}Discussion, family = binomial(logit), data = train)}
\NormalTok{model }\OtherTok{=} \FunctionTok{glm}\NormalTok{(ClassH }\SpecialCharTok{\textasciitilde{}}\NormalTok{Discussion, }\AttributeTok{family =} \FunctionTok{binomial}\NormalTok{(logit), }\AttributeTok{data =}\NormalTok{ train)}
\FunctionTok{summary}\NormalTok{(model)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = ClassH ~ Discussion, family = binomial(logit), 
##     data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.3021  -0.8112  -0.6382   1.1886   2.0067  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(>|z|)    
## (Intercept) -1.915034   0.256885  -7.455 9.00e-14 ***
## Discussion   0.022485   0.004552   4.939 7.85e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 407.40  on 335  degrees of freedom
## Residual deviance: 381.53  on 334  degrees of freedom
## AIC: 385.53
## 
## Number of Fisher Scoring iterations: 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{test}\SpecialCharTok{$}\NormalTok{predicted.ClassH }\OtherTok{=} \FunctionTok{predict}\NormalTok{(model, }\AttributeTok{newdata=}\NormalTok{test, }\AttributeTok{type=}\StringTok{"response"}\NormalTok{)}
\FunctionTok{table}\NormalTok{(test}\SpecialCharTok{$}\NormalTok{ClassH, test}\SpecialCharTok{$}\NormalTok{predicted.ClassH }\SpecialCharTok{\textgreater{}} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    
##     FALSE TRUE
##   0    92    9
##   1    36    7
\end{verbatim}

Độ chính xác

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\DecValTok{92}\SpecialCharTok{+}\DecValTok{7}\NormalTok{)}\SpecialCharTok{/}\NormalTok{(}\DecValTok{92}\SpecialCharTok{+}\DecValTok{7}\SpecialCharTok{+}\DecValTok{9}\SpecialCharTok{+}\DecValTok{36}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.6875
\end{verbatim}

\end{document}
